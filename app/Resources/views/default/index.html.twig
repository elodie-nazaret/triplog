{% extends '::base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2-bootstrap-css/1.4.6/select2-bootstrap.min.css"/>
{% endblock %}

{% block body_class %}profile-page{% endblock %}

{% block content %}
    <div class="wrapper">
        <div class="header header-filter" style="background-image: url('http://www.pixelstalk.net/wp-content/uploads/2016/04/Fantasy-Lake-Landscape-Wallpaper-Picture.jpg'); background-size: cover; background-position: top center;"></div>
        <div class="row">
            <div class="main main-raised">
                <div class="profile-content">
                    <div class="container">
                        <div class="row">
                            <div class="card card-signup" style="box-shadow: none;">
                                <div class="header header-info text-center" style="max-height: 100px;">
                                    <h3>Rechercher un voyage</h3>
                                </div>
                            </div>
                            <div class="col-md-12 text-center">
                                <div class="input-group">
                            <span class="input-group-addon">
                                <i class="material-icons">face</i>
                            </span>
                                    <input id="search-input" type="text" class="form-control" autocomplete="off" spellcheck="false" autocorrect="off" placeholder="Recherchez un terme (ville, rue, ...)" tabindex="-1"/>
                                </div>
                            </div>
                        </div>
                        <div class="row" style="margin-top: 20px;">
                            <div class="col-md-12 text-center">
                                <div>
                                    <div id="facets" class="text-left"></div>
                                    <p><a class="clear-all" href="#">Réinitialiser les filtres</a></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row" style="margin-top: 80px;">
            <div class="main main-raised">
                <div class="profile-content">
                    <div class="container">
                        <div class="row">
                            <div class="col-md-12 text-center">
                                <div id="trips">
                                    <h2 id="stats" class="text-center"></h2>
                                    <div id="hits"></div>
                                    <div id="pagination"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block javascripts %}
    <script src="http://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js"></script>
    <script src="http://cdn.jsdelivr.net/algoliasearch.helper/2/algoliasearch.helper.min.js"></script>
    <script src="http://cdn.jsdelivr.net/hogan.js/3.0.2/hogan.min.common.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.full.min.js"></script>
    <script>
        var APPLICATION_ID = "{{ algolia_app_id }}";
        var SEARCH_ONLY_API_KEY = "{{ algolia_search_api_key }}";
        var INDEX_NAME = "{{ algolia_index_name }}";
        var PARAMS = {
            facets: [{% for facet in facets %}'{{ facet }}'{% if not loop.last %}, {% endif %}{% endfor %}]
        };
        var FACETS_ORDER_OF_DISPLAY = [{% for facet in facets %}'{{ facet }}'{% if not loop.last %}, {% endif %}{% endfor %}];
        var FACETS_LABEL = [{% for facet in facets %}'{{ facet|trans() }}'{% if not loop.last %}, {% endif %}{% endfor %}];
        var nbFacets = {{ facets|length }};
    </script>

    {% verbatim %}
    <script type="text/template" id="hit-template">
        {{#hits}}
        <div class="hit">
            <article class="trip text-center">
                <div class="hit-body" style="cursor: pointer;" data-id="{{ objectID }}">
                    <header>
                        <!--{{#first_picture}}<img class="img-responsive center-block" src="/{{first_picture.picture_url}}" alt="" width="225" height="125" />{{/first_picture}}-->
                        <h1 class="h3-like">{{{_highlightResult.name.value}}}</h1>
                    </header>
                    <p>
                        <span class="">{{{_highlightResult.user.firstName.value}}} {{{_highlightResult.user.lastName.value}}}</span> -
                    </p>
                </div>
                <div class="hit-footer trip_view" id="view_{{post_id}}" style="cursor: pointer;">
                    <p>Voir le voyage</p>
                </div>
            </article>
        </div>
        {{/hits}}
    </script>

    <script type="text/template" id="stats-template">
       <p class="nb-hits">{{nbHits}} résultat{{#nbHits_plural}}s{{/nbHits_plural}}</p>
    </script>

    <script type="text/template" id="pagination-template">
        <ul>
            <li {{^prev_page}}class="disabled"{{/prev_page}}><a href="#" {{#prev_page}}class="go-to-page" data-page="{{ prev_page }}"{{/prev_page}}>&#60;</a></li>
            {{#pages}}
            <li class="{{#current}}active{{/current}} {{#disabled}}disabled{{/disabled}}"><a href="#" {{^disabled}} class="go-to-page" data-page="{{ number }}" {{/disabled}}>{{ number }}</a></li>
            {{/pages}}
            <li {{^next_page}}class="disabled"{{/next_page}}><a href="#" {{#next_page}}class="go-to-page" data-page="{{ next_page }}"{{/next_page}}>&#62;</a></li>
        </ul>
    </script>

    <script type="text/template" id="facet-template">
        <div class="facet col-md-6">
            <h5>{{ title }}</h5>
            <div class="col-md-11">
                <select id="{{id}}-select" class="facet-select form-control" >
                {{#haveToDisplayDefaultOption}}<option value="" disabled selected>Sélectionnez une option</option>{{/haveToDisplayDefaultOption}}
                    {{#values}}
                        <option class="facet-link {{#disjunctive}}facet-disjunctive{{/disjunctive}} {{#isRefined}}facet-refined{{/isRefined}}" data-facet="{{ facet }}" value="{{ name }}">{{ name }}</option>
                    {{/values}}
                </select>
            </div>
            <div class="col-md-1">
                <button class="btn btn-primary btn-fab btn-fab-mini btn-round clear-facet" data-facet="{{ facet }}">
	                <i class="material-icons">autorenew</i>
                </button>
            </div>
        </div>
    </script>
{% endverbatim %}

    <script src="{{ asset('bundles/app/js/search.js') }}"></script>
{% endblock %}